%import common.WS
%import common.ESCAPED_STRING   -> CTESTRING
%ignore WS

ID: /[_]?[a-z]+[a-zA-Z0-9_]*/
CTEINT: /[0-9]+/
CTEFLOAT: /[0-9]+[\.][0-9]+/
PATH: /[^\\s]+(.*?)\\.(jpg|jpeg|png|gif|JPG|JPEG|PNG|GIF)$/


// TOKENS
PROGRAM: "Gauss"
ORGANIZACION: "organizacion"
ETAPA: "etapa"
CATEGORIAS: "categorias"
PROBLEMA: "problema"
AREA: "area"
CATEGORIA: "categoria"
EXPR: "expr"
IMPORT: "import"
OPCIONES: "opciones"
RESPUESTA: "respuesta"
VAR: "var"
INT: "int"
FLOAT: "float"
STRING: "string"
BOOL: "bool"
VOID: "void"
IF: "if"
ELSE: "else"
TRUE: "True"
FALSE: "False"
MAIN: "main"
RETURN: "return"
WHILE: "while"
NOMBREARCHIVO: "nombreArchivo"
GENERA: "genera"
FECHA: "fecha"
ORIENTACION: "orientacion"
PROBLEMAS: "problemas"
HEADER: "header"
TITULO: "titulo"
INSTRUCCIONES: "instrucciones"
PROBLEMASINCLUIDOS: "problemasIncluidos"
RANDOM: "random"
FOOTER: "footer"
PRINT: />>/
PUNTOYCOMA: /;/
DOSPUNTOS: /:/
LCURLY: /{/
RCURLY: /\}/
IGUAL: /=/
MENORQUE: /</
MAYORQUE: />/
DIFERENTE: /<>/
MAS: /\+/
MENOS: /-/
MULT: /\*/
DIV: /\//
LPAR: /\(/
RPAR: /\)/
LCOR: /\[/
RCOR: /\]/
COMA: /,/
PRINTP: />>/
DOLLAR: /\$/

// GRAMATICA
start: program 
program: PROGRAM ID info vars modulos problemas listas genera main np_end

info: ORGANIZACION IGUAL CTESTRING ETAPA IGUAL CTESTRING CATEGORIAS IGUAL arr

vars: VAR np_vars | 
vars1: vars2 | IGUAL expresion vars2 | IGUAL varcte vars2
vars2: COMA ID vars1 | np_fin_vars
np_vars: tipo ID vars1 vars
np_fin_vars:

modulos: modulo | 
modulo: tipomod ID LPAR modids RPAR LCURLY vars estatutos return RCURLY modulos np_endfunc

problemas: problema | 
problema: PROBLEMA ID LPAR AREA IGUAL CTESTRING prob1 RPAR LCURLY categoria printprob opciones respuesta RCURLY np_endfunc
prob1: COMA ID prob1 | 
categoria: CATEGORIA IGUAL arracc | 
printprob: PRINTP printprob1 printprob | 
printprob1: CTESTRING | DOLLAR EXPR LPAR CTESTRING RPAR | DOLLAR IMPORT LPAR PATH RPAR
opciones: OPCIONES IGUAL arr | 
respuesta: RESPUESTA IGUAL varcte 

listas: lista | 
lista: ID IGUAL arr listas

genera: GENERA LPAR ORIENTACION COMA CATEGORIA COMA PROBLEMAS COMA NOMBREARCHIVO RPAR LCURLY header titulo instrucciones problemasincluidos footer RCURLY np_endfunc
header: HEADER LPAR ORGANIZACION COMA FECHA head1 COMA ETAPA RPAR
head1: IGUAL CTESTRING | 
titulo: TITULO LPAR CTESTRING RPAR
instrucciones: INSTRUCCIONES LPAR CTESTRING RPAR
problemasincluidos: PROBLEMASINCLUIDOS LPAR PROBLEMAS COMA RANDOM IGUAL ctebool RPAR
footer: FOOTER LPAR CATEGORIA RPAR 

main: MAIN LPAR RPAR bloque np_endfunc

estatutos: estatuto estatutos |
estatuto: asignacion | condicion | ciclo | escritura | llamadafunc

return: RETURN varcte | 
tipomod: INT | FLOAT | STRING | BOOL | VOID
modids: modids1 | 
modids1: ID modids2 
modids2: COMA modids1 | 

arr: LCOR varcte arr1 RCOR
arr1: COMA varcte arr1 | 

arracc: ID LCOR CTEINT RCOR

expresion: exp expresion1 exp | exp
expresion1: MENORQUE | MAYORQUE | DIFERENTE

exp: termino np_exp exp1 | termino np_exp
exp1: MAS exp | MENOS exp
np_exp:

termino: factor np_termino ter1 | factor np_termino 
ter1: MULT termino | DIV termino 
np_termino:

factor: LPAR expresion RPAR | fact1 | fact2
fact1: varcte
fact2: ID

tipo: INT | FLOAT | STRING | BOOL

asignacion: ID asig1 IGUAL asig2
asig1: LCOR CTEINT RCOR | 
asig2: expresion | llamadafunc | arracc

condicion: IF LPAR expresion RPAR bloque cond1
cond1: ELSE bloque | 

ciclo: WHILE LPAR expresion RPAR bloque

escritura: PRINT LPAR varcte escr1 RPAR 
escr1: COMA varcte escr1 | 

varcte: ID | CTEINT | CTEFLOAT | CTESTRING | ctebool
ctebool: TRUE | FALSE

llamadafunc: ID LPAR varcte llam1 RPAR
llam1: COMA varcte llam1 | 

bloque: LCURLY estatutos RCURLY

np_end: 
np_endfunc:

mult: MULT
div: DIV